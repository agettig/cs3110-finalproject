open Players
open Tiles

let spinner = Random.int 11 + 1

module IntTilesTupl = struct
  type t = int * tiles

  let compare pos1 pos2 =
    match Stdlib.compare pos1 pos2 with
    | 0 -> 0
    | comp -> comp
end

module BoardMap = Map.Make (IntTilesTupl)

let empty_board = BoardMap.empty

(*Need to talk about how to instantiate everything like all the tile
  types*)
let pos_to_tuple pos =
  match pos with
  | 0 -> (0, List.nth gold_tiles 0)
  | 1 -> (1, List.nth gold_tiles 1)
  | 2 -> (2, List.nth gold_tiles 2)
  | 3 -> (3, List.nth gold_tiles 3)
  | 4 -> (4, List.nth gold_tiles 4)
  | 5 -> (5, List.nth gold_tiles 5)
  | 6 -> (6, List.nth gold_tiles 6)
  | 7 -> (7, List.nth gold_tiles 7)
  | 8 -> (8, List.nth gold_tiles 8)
  | 9 -> (9, List.nth gold_tiles 9)
  | 10 -> (10, List.nth gold_tiles 10)
  | 11 -> (11, List.nth gold_tiles 11)
  | 12 -> (12, List.nth gold_tiles 12)
  | 13 -> (13, List.nth gold_tiles 13)
  | 14 -> (14, List.nth gold_tiles 14)
  | 15 -> (1, List.nth gold_tiles 1)
  | 16 -> (16, List.nth gold_tiles 16)
  | 17 -> (17, List.nth gold_tiles 17)
  | 18 -> (18, List.nth gold_tiles 18)
  | 19 -> (19, List.nth gold_tiles 19)
  | 20 -> (20, List.nth gold_tiles 20)
  | 21 -> (21, List.nth gold_tiles 21)
  | 22 -> (22, List.nth gold_tiles 22)
  | 23 -> (23, List.nth gold_tiles 23)
  | 24 -> (24, List.nth gold_tiles 24)
  | 25 -> (25, List.nth gold_tiles 25)
  | 26 -> (26, List.nth gold_tiles 26)
  | 27 -> (27, List.nth gold_tiles 27)
  | 28 -> (28, List.nth gold_tiles 28)
  | 29 -> (29, List.nth gold_tiles 29)
  | 30 -> (30, List.nth gold_tiles 30)
  | 31 -> (31, List.nth gold_tiles 31)
  | 32 -> (32, List.nth gold_tiles 32)
  | 33 -> (33, List.nth gold_tiles 33)
  | 34 -> (34, List.nth gold_tiles 34)
  | 35 -> (35, List.nth gold_tiles 35)
  | 36 -> (36, List.nth gold_tiles 36)
  | 37 -> (37, List.nth gold_tiles 37)
  | 38 -> (38, List.nth gold_tiles 38)
  | 39 -> (39, List.nth gold_tiles 39)
  | 40 -> (40, List.nth gold_tiles 40)
  | 41 -> (41, List.nth gold_tiles 41)
  | 42 -> (42, List.nth gold_tiles 42)
  | 43 -> (43, List.nth gold_tiles 43)
  | 44 -> (44, List.nth gold_tiles 44)
  | 45 -> (45, List.nth gold_tiles 45)
  | 46 -> (46, List.nth gold_tiles 46)
  | 47 -> (47, List.nth gold_tiles 47)
  | 48 -> (48, List.nth gold_tiles 48)
  | 49 -> (49, List.nth gold_tiles 49)
  | 50 -> (50, List.nth gold_tiles 50)
  | 51 -> (51, List.nth gold_tiles 51)
  | 52 -> (52, List.nth gold_tiles 52)
  | 53 -> (53, List.nth gold_tiles 53)
  | 54 -> (54, List.nth gold_tiles 54)
  | 55 -> (55, List.nth gold_tiles 55)
  | 56 -> (56, List.nth gold_tiles 56)
  | 57 -> (57, List.nth gold_tiles 57)
  | 58 -> (58, List.nth gold_tiles 58)
  | 59 -> (59, List.nth gold_tiles 59)
  | 60 -> (60, List.nth gold_tiles 60)
  | 61 -> (61, List.nth gold_tiles 61)
  | 62 -> (62, List.nth gold_tiles 62)
  | 63 -> (63, List.nth gold_tiles 63)
  | 64 -> (64, List.nth gold_tiles 64)
  | 65 -> (65, List.nth gold_tiles 65)
  | 66 -> (66, List.nth gold_tiles 66)
  | 67 -> (67, List.nth gold_tiles 67)
  | 68 -> (68, List.nth gold_tiles 68)
  | 69 -> (69, List.nth gold_tiles 69)
  | 70 -> (70, List.nth gold_tiles 70)
  | 71 -> (71, List.nth gold_tiles 71)
  | 72 -> (72, List.nth gold_tiles 72)
  | 73 -> (73, List.nth gold_tiles 73)
  | 74 -> (74, List.nth gold_tiles 74)
  | 75 -> (75, List.nth gold_tiles 75)
  | 76 -> (76, List.nth gold_tiles 76)
  | 77 -> (77, List.nth gold_tiles 77)
  | 78 -> (78, List.nth gold_tiles 78)
  | 79 -> (79, List.nth gold_tiles 79)
  | 80 -> (80, List.nth gold_tiles 80)
  | 81 -> (81, List.nth gold_tiles 81)
  | 82 -> (82, List.nth gold_tiles 82)
  | 83 -> (83, List.nth gold_tiles 83)
  | 84 -> (84, List.nth gold_tiles 84)
  | 85 -> (85, List.nth gold_tiles 85)
  | 86 -> (86, List.nth gold_tiles 86)
  | 87 -> (87, List.nth gold_tiles 87)
  | 88 -> (88, List.nth gold_tiles 88)
  | 89 -> (89, List.nth gold_tiles 89)
  | 90 -> (90, List.nth gold_tiles 90)
  | 91 -> (91, List.nth gold_tiles 91)
  | 92 -> (92, List.nth gold_tiles 92)
  | 93 -> (93, List.nth gold_tiles 93)
  | 94 -> (94, List.nth gold_tiles 94)
  | 95 -> (95, List.nth gold_tiles 95)
  | 96 -> (96, List.nth gold_tiles 96)
  | 97 -> (97, List.nth gold_tiles 97)
  | 98 -> (98, List.nth gold_tiles 98)
  | 99 -> (99, List.nth gold_tiles 99)
  | 100 -> (100, List.nth gold_tiles 100)
  | 101 -> (101, List.nth gold_tiles 101)
  | 102 -> (102, List.nth gold_tiles 102)
  | 103 -> (103, List.nth gold_tiles 103)
  | 104 -> (104, List.nth gold_tiles 104)
  | 105 -> (105, List.nth gold_tiles 105)
  | 106 -> (106, List.nth gold_tiles 106)
  | 107 -> (107, List.nth gold_tiles 107)
  | 108 -> (108, List.nth gold_tiles 108)
  | 109 -> (109, List.nth gold_tiles 109)
  | 110 -> (110, List.nth gold_tiles 110)
  | 111 -> (111, List.nth gold_tiles 111)
  | 112 -> (112, List.nth gold_tiles 112)
  | 113 -> (113, List.nth gold_tiles 113)
  | 114 -> (114, List.nth gold_tiles 114)
  | 115 -> (115, List.nth gold_tiles 115)
  | 116 -> (116, List.nth gold_tiles 116)
  | 117 -> (117, List.nth gold_tiles 117)
  | 118 -> (118, List.nth gold_tiles 118)
  | 119 -> (119, List.nth gold_tiles 119)
  | 120 -> (120, List.nth gold_tiles 120)
  | 121 -> (121, List.nth gold_tiles 121)
  | 122 -> (122, List.nth gold_tiles 122)
  | 123 -> (123, List.nth gold_tiles 123)
  | 124 -> (124, List.nth gold_tiles 124)
  | 125 -> (125, List.nth gold_tiles 125)
  | 126 -> (126, List.nth gold_tiles 126)
  | 127 -> (127, List.nth gold_tiles 127)
  | 128 -> (128, List.nth gold_tiles 128)
  | 129 -> (129, List.nth gold_tiles 129)
  | num ->
      if num > 0 then
        if num > 129 then raise (Failure "out of bounds position")
        else (129, List.nth gold_tiles 129)
      else raise (Failure "out of bounds position")
